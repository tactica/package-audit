require_relative './base'
require_relative '../bash_color'

module Package
  module Audit
    module Formatter
      class Vulnerability < Formatter::Base
        def initialize(vulnerability)
          super()
          @vulnerability = vulnerability || ''
        end

        def format
          case @vulnerability
          when Enum::VulnerabilityType::UNKNOWN, Enum::VulnerabilityType::CRITICAL, Enum::VulnerabilityType::HIGH
            BashColor.red(@vulnerability)
          when Enum::VulnerabilityType::MEDIUM
            BashColor.orange(@vulnerability)
          when Enum::VulnerabilityType::LOW
            BashColor.yellow(@vulnerability)
          else
            @vulnerability
          end
        end
      end
    end
  end
end
