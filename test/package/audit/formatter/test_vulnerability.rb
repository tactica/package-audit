require_relative '../../../../lib/package/audit/enum/vulnerability_type'
require_relative '../../../../lib/package/audit/formatter/vulnerability'
require_relative '../../../../lib/package/audit/util/bash_color'

require 'test_helper'

module Package
  module Audit
    module Formatter
      class TestVulnerability < Minitest::Test
        def test_that_unknown_vulnerabilities_are_shown_in_proper_color
          vulnerability = Enum::VulnerabilityType::UNKNOWN
          format = Vulnerability.new(vulnerability).format
          assert_equal Util::BashColor.red(vulnerability), format
        end

        def test_that_critical_vulnerabilities_are_shown_in_proper_color
          vulnerability = Enum::VulnerabilityType::CRITICAL
          format = Vulnerability.new(vulnerability).format
          assert_equal Util::BashColor.red(vulnerability), format
        end

        def test_that_high_vulnerabilities_are_shown_in_proper_color
          vulnerability = Enum::VulnerabilityType::HIGH
          format = Vulnerability.new(vulnerability).format
          assert_equal Util::BashColor.red(vulnerability), format
        end

        def test_that_medium_vulnerabilities_are_shown_in_proper_color
          vulnerability = Enum::VulnerabilityType::MEDIUM
          format = Vulnerability.new(vulnerability).format
          assert_equal Util::BashColor.orange(vulnerability), format
        end

        def test_that_low_vulnerabilities_are_shown_in_proper_color
          vulnerability = Enum::VulnerabilityType::LOW
          format = Vulnerability.new(vulnerability).format
          assert_equal Util::BashColor.yellow(vulnerability), format
        end

        def test_that_none_vulnerabilities_have_no_special_color
          vulnerability = Enum::VulnerabilityType::NONE
          format = Vulnerability.new(vulnerability).format
          assert_equal vulnerability, format
        end

        def test_that_unlisted_vulnerabilities_have_no_special_color
          vulnerability = 'example'
          format = Vulnerability.new(vulnerability).format
          assert_equal vulnerability, format
        end
      end
    end
  end
end
